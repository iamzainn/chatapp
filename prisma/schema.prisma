generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id           String    @id @unique
  email        String    @unique
  firstName    String
  lastName     String
  profileImage String
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  chats        UserChat[]
  messages     Message[]

  
}

model Chat {
  id            Int         @id @default(autoincrement())
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  isGroupChat   Boolean     @default(false)
  groupAdminId  String?     
  users         UserChat[]
  messages      Message[]   @relation("ChatMessages")
  
}

model Message {
  id        Int      @id @default(autoincrement())
  content   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  senderId  String
  type      MessageType
  sender    User     @relation(fields: [senderId], references: [id])
  chatId    Int
  chat      Chat     @relation("ChatMessages", fields: [chatId], references: [id])

 
}

model UserChat {
  userId String
  chatId Int

  user User @relation(fields: [userId], references: [id])
  chat Chat @relation(fields: [chatId], references: [id])

  @@id([userId, chatId])
}


enum MessageType {
  text
  image
  video
}